<h2>{{ carrera.pais }} ‚Äì {{ carrera.fecha }}</h2>

<hr>

<h3>üìù Informaci√≥n de la fecha</h3>

{% if session.admin %}
<form method="post">
    <textarea name="info_fecha" rows="5" style="width:100%">{{ carrera.info_fecha }}</textarea>
    <br><br>
    <button type="submit">Guardar info</button>
</form>
{% else %}
<p>{{ carrera.info_fecha or "Sin informaci√≥n cargada." }}</p>
{% endif %}
{% if pendientes %}
<div style="background:#ffeeba;padding:10px;margin-bottom:15px">
    ‚ö†Ô∏è <strong>Pron√≥sticos pendientes:</strong>
    {{ pendientes | length }} participante(s) a√∫n no cargaron.
</div>
{% endif %}
{% if segundos_restantes is not none and segundos_restantes > 0 %}
<script>
    let segundos = {{ segundos_restantes }};
    const el = document.getElementById("contador");

    function tick() {
        if (segundos <= 0) return;
        segundos--;

        let h = Math.floor(segundos / 3600);
        let m = Math.floor((segundos % 3600) / 60);
        let s = segundos % 60;

        el.innerText = `${h}h ${m}m ${s}s`;
    }

    tick();
    setInterval(tick, 1000);
</script>
{% endif %}


<hr>

<h3>‚úÖ Pron√≥sticos cargados</h3>

<table border="1">
    <thead>
        <tr>
            <th>Usuario</th>
            <th>Pole</th>
            {% if carrera.sprint %}
                <th>Sprint</th>
            {% endif %}
            <th>P1</th>
            <th>P2</th>
            <th>P3</th>
        </tr>
    </thead>
    <tbody>
        {% for p in pronosticos %}
        <tr>
            <td>{{ p.usuario }}</td>
            <td>{{ p.pole }}</td>
            {% if carrera.sprint %}
                <td>{{ p.sprint_ganador }}</td>
            {% endif %}
            <td>{{ p.p1 }}</td>
            <td>{{ p.p2 }}</td>
            <td>{{ p.p3 }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<hr>
{% if carrera.pronostico_abierto %}
    <a href="/pronostico/{{ carrera.id }}">
        <button>Cargar / Editar pron√≥stico</button>
    </a>
{% else %}
    <p><strong>Pron√≥stico cerrado</strong></p>
{% endif %}


<h3>‚è≥ Pendientes de cargar</h3>

{% if pendientes %}
<ul>
    {% for u in pendientes %}
        <li>{{ u.nombre }}</li>
    {% endfor %}
</ul>
{% else %}
<p>üéâ Todos cargaron su pron√≥stico</p>
{% endif %}

<br>
<a href="/calendario">‚Üê Volver al calendario</a>
